<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•è¯æ•…äº‹å­¦ä¹ ç³»ç»Ÿ MVP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5;
            --primary-light: #6366f1;
            --primary-dark: #4338ca;
            --secondary-color: #10b981;
            --secondary-light: #34d399;
            --secondary-dark: #059669;
            --accent-color: #f59e0b;
            --accent-light: #fbbf24;
            --accent-dark: #d97706;
            --danger-color: #ef4444;
            --danger-light: #f87171;
            --danger-dark: #dc2626;
            --background-light: #f8fafc;
            --background-white: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-light: #94a3b8;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', 'Noto Sans SC', sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--background-white);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            padding: 40px;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }

        header::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.8rem;
            margin-bottom: 12px;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
            text-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.2rem;
            font-weight: 400;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .section-header h2 {
            color: var(--text-primary);
            font-size: 1.8rem;
            font-weight: 600;
            position: relative;
            padding-left: 15px;
        }

        .section-header h2::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary-color);
            border-radius: 2px;
        }

        .word-count {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #toggleMode {
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow-md);
        }

        #toggleMode:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        }

        .story-container {
            background: var(--background-light);
            padding: 30px;
            border-radius: var(--radius-lg);
            line-height: 1.8;
            font-size: 1.15rem;
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
            position: relative;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
        }

        .story-container:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--primary-light);
        }

        .story-complete-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--secondary-light), var(--secondary-color));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow-md);
            z-index: 10;
        }

        .story-complete-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: linear-gradient(135deg, var(--secondary-color), var(--secondary-dark));
        }

        .story-complete-btn.completed {
            background: linear-gradient(135deg, var(--text-light), var(--text-secondary));
        }

        .story-complete-btn.completed:hover {
            background: linear-gradient(135deg, var(--text-secondary), var(--text-primary));
        }

        .word-chinese {
            color: var(--danger-color);
            font-weight: 600;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 4px;
            transition: all var(--transition-fast);
            position: relative;
            background: linear-gradient(120deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.05));
            border-bottom: 2px solid transparent;
        }

        .word-chinese:hover {
            background: linear-gradient(120deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
            transform: translateY(-2px);
            border-bottom: 2px solid var(--danger-color);
        }

        .word-chinese.mastered {
            color: var(--secondary-color);
            background: linear-gradient(120deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05));
            text-decoration: none;
            opacity: 0.9;
        }

        .word-chinese.mastered:hover {
            background: linear-gradient(120deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1));
            border-bottom: 2px solid var(--secondary-color);
        }

        .word-english {
            color: var(--primary-color);
            font-weight: 600;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 4px;
            transition: all var(--transition-fast);
            position: relative;
            background: linear-gradient(120deg, rgba(79, 70, 229, 0.1), rgba(79, 70, 229, 0.05));
            border-bottom: 2px solid transparent;
        }

        .word-english:hover {
            background: linear-gradient(120deg, rgba(79, 70, 229, 0.2), rgba(79, 70, 229, 0.1));
            transform: translateY(-2px);
            border-bottom: 2px solid var(--primary-color);
        }

        .word-english.mastered {
            color: var(--secondary-color);
            background: linear-gradient(120deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05));
            text-decoration: none;
            opacity: 0.9;
        }

        .word-english.mastered:hover {
            background: linear-gradient(120deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1));
            border-bottom: 2px solid var(--secondary-color);
        }

        .instructions {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.05), rgba(16, 185, 129, 0.05));
            padding: 20px;
            border-radius: var(--radius-md);
            margin-top: 25px;
            font-size: 0.95rem;
            border: 1px solid rgba(79, 70, 229, 0.1);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .instructions i {
            color: var(--primary-color);
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .highlight {
            color: var(--primary-color);
            font-weight: 600;
            background: rgba(79, 70, 229, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }

        .words-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
        }

        .progress-info {
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
            color: white;
            padding: 10px 20px;
            border-radius: var(--radius-md);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow-md);
        }

        .progress-info span {
            font-size: 1.1rem;
        }

        #masteredCount {
            font-weight: 700;
            font-size: 1.3rem;
        }

        .words-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .word-card {
            background: var(--background-white);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .word-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-light), var(--primary-color));
            opacity: 0;
            transition: opacity var(--transition-normal);
        }

        .word-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-light);
        }

        .word-card:hover::before {
            opacity: 1;
        }

        .word-card.mastered {
            border-color: var(--secondary-light);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(16, 185, 129, 0.02));
        }

        .word-card.mastered::before {
            background: linear-gradient(90deg, var(--secondary-light), var(--secondary-color));
            opacity: 1;
        }

        .word-card h4 {
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .word-card .phonetic {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 10px;
            font-style: italic;
        }

        .word-card .meaning {
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .mastery-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, var(--secondary-light), var(--secondary-color));
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            box-shadow: var(--shadow-md);
        }

        .word-mastery-btn {
            margin-top: 15px;
            width: 100%;
            padding: 10px;
            border: none;
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
            color: white;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .word-mastery-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        }

        .word-mastery-btn.mastered {
            background: linear-gradient(135deg, var(--secondary-light), var(--secondary-color));
        }

        .word-mastery-btn.mastered:hover {
            background: linear-gradient(135deg, var(--secondary-color), var(--secondary-dark));
        }

        .favorite-star {
            color: var(--accent-color);
            font-size: 1.3rem;
            transition: all var(--transition-fast);
        }

        .favorite-star:hover {
            color: var(--accent-dark);
            transform: scale(1.2);
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn var(--transition-normal);
        }

        .modal-content {
            background: var(--background-white);
            width: 90%;
            max-width: 550px;
            border-radius: var(--radius-xl);
            padding: 35px;
            position: relative;
            animation: modalSlideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 24px;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-light);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }

        .close-btn:hover {
            background: var(--background-light);
            color: var(--danger-color);
            transform: rotate(90deg);
        }

        .word-header {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .word-header h3 {
            color: var(--text-primary);
            font-size: 2.2rem;
            margin-bottom: 8px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .mastery-indicator {
            font-size: 0.9rem;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 500;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.05));
            color: var(--danger-color);
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .mastery-indicator.mastered {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05));
            color: var(--secondary-color);
        }

        .phonetic {
            color: var(--text-secondary);
            font-style: italic;
            font-size: 1.1rem;
            display: block;
            margin-top: 5px;
        }

        .word-details {
            margin-top: 20px;
        }

        .word-details p {
            margin-bottom: 15px;
            font-size: 1rem;
            line-height: 1.6;
        }

        .word-details strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .example {
            margin: 25px 0;
            padding: 20px;
            background: var(--background-light);
            border-radius: var(--radius-md);
            border-left: 4px solid var(--primary-color);
        }

        .english-example {
            color: var(--text-primary);
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-style: italic;
            line-height: 1.6;
        }

        .chinese-example {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.6;
        }

        .word-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 30px;
        }

        .speak-btn, .favorite-btn, .mastery-btn {
            padding: 14px;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 500;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .speak-btn {
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
            color: white;
        }

        .speak-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        }

        .favorite-btn {
            background: linear-gradient(135deg, var(--accent-light), var(--accent-color));
            color: white;
        }

        .favorite-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            background: linear-gradient(135deg, var(--accent-color), var(--accent-dark));
        }

        .favorite-btn.favorited {
            background: linear-gradient(135deg, var(--danger-light), var(--danger-color));
        }

        .favorite-btn.favorited:hover {
            background: linear-gradient(135deg, var(--danger-color), var(--danger-dark));
        }

        .mastery-btn {
            background: linear-gradient(135deg, var(--secondary-light), var(--secondary-color));
            color: white;
            grid-column: span 2;
        }

        .mastery-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            background: linear-gradient(135deg, var(--secondary-color), var(--secondary-dark));
        }

        .mastery-btn.mastered {
            background: linear-gradient(135deg, var(--text-light), var(--text-secondary));
        }

        .mastery-btn.mastered:hover {
            background: linear-gradient(135deg, var(--text-secondary), var(--text-primary));
        }

        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 25px;
            border-top: 1px solid var(--border-color);
            color: var(--text-light);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        footer p {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        /* è£…é¥°å…ƒç´  */
        .decoration {
            position: absolute;
            z-index: -1;
            opacity: 0.1;
        }

        .decoration-1 {
            top: 10%;
            left: 5%;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
            animation: float 20s ease-in-out infinite;
        }

        .decoration-2 {
            bottom: 10%;
            right: 5%;
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
            border-radius: 70% 30% 30% 70% / 70% 70% 30% 30%;
            animation: float 25s ease-in-out infinite reverse;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-20px) rotate(180deg);
            }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 25px 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
            
            .words-list {
                grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
            }
            
            .modal-content {
                width: 95%;
                padding: 25px 20px;
            }
            
            .word-actions {
                grid-template-columns: 1fr;
            }
            
            .mastery-btn {
                grid-column: span 1;
            }
            
            .story-complete-btn {
                position: relative;
                top: 0;
                right: 0;
                width: 100%;
                margin-bottom: 15px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .section-header h2 {
                font-size: 1.5rem;
            }
            
            .words-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="decoration decoration-1"></div>
    <div class="decoration decoration-2"></div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-book-open"></i> å•è¯æ•…äº‹å­¦ä¹ ç³»ç»Ÿ</h1>
            <p class="subtitle">é€šè¿‡æœ‰è¶£çš„æ•…äº‹è½»æ¾è®°å¿†è‹±è¯­å•è¯ï¼Œè®©å­¦ä¹ æˆä¸ºä¸€ç§äº«å—</p>
        </header>

        <main>
            <section class="story-section">
                <div class="section-header">
                    <h2><i class="fas fa-mountain"></i> ç¥ç§˜æ£®æ—çš„å†’é™©</h2>
                    <div class="word-count">
                        <span><i class="fas fa-list-check"></i> åŒ…å«å•è¯: 10ä¸ª</span>
                        <button id="toggleMode">
                            <i class="fas fa-language"></i>
                            <span>æ˜¾ç¤ºè‹±æ–‡æ¨¡å¼</span>
                        </button>
                    </div>
                </div>
                
                <div class="story-container" id="storyContainer">
                    <button class="story-complete-btn" id="storyCompleteBtn">
                        <i class="fas fa-check-circle"></i>
                        <span>æ ‡è®°æ•…äº‹ä¸ºå·²å­¦å®Œ</span>
                    </button>
                    <!-- æ•…äº‹å†…å®¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div class="instructions">
                    <i class="fas fa-lightbulb"></i>
                    <p>ğŸ’¡ <strong>ä½¿ç”¨æç¤ºï¼š</strong>ç‚¹å‡»<span class="highlight">ä¸­æ–‡å•è¯</span>æ˜¾ç¤ºè‹±æ–‡ï¼Œç‚¹å‡»<span class="highlight">è‹±æ–‡å•è¯</span>æŸ¥çœ‹è¯¦æƒ…ã€‚æŒæ¡å•è¯åä¼šåœ¨æ•…äº‹ä¸­æ ‡è®°ä¸ºç»¿è‰²ã€‚</p>
                </div>
            </section>

            <section class="words-section">
                <div class="section-header">
                    <h2><i class="fas fa-graduation-cap"></i> æœ¬æ•…äº‹åŒ…å«çš„å•è¯</h2>
                    <div class="progress-info" id="progressInfo">
                        <i class="fas fa-chart-line"></i>
                        <span>æŒæ¡è¿›åº¦: <span id="masteredCount">0</span>/10</span>
                    </div>
                </div>
                <div class="words-list" id="wordsList">
                    <!-- å•è¯åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </section>
        </main>

        <footer>
            <p>
                <i class="fas fa-code"></i>
                <span>å•è¯å­¦ä¹ ç³»ç»Ÿ MVP æ¼”ç¤ºç‰ˆ | ç‚¹å‡»å•è¯å¼€å§‹å­¦ä¹  | æ‰€æœ‰åŠŸèƒ½åœ¨ä¸€ä¸ªHTMLæ–‡ä»¶ä¸­</span>
                <i class="fas fa-heart" style="color: #ef4444;"></i>
            </p>
        </footer>
    </div>

    <!-- å•è¯è¯¦æƒ…å¼¹çª— -->
    <div class="modal" id="wordModal">
        <div class="modal-content">
            <button class="close-btn" id="closeModal">Ã—</button>
            <div class="word-header">
                <h3 id="modalEnglish">
                    <span id="modalEnglishText"></span>
                    <span class="mastery-indicator" id="modalMasteryIndicator">
                        <i class="fas fa-circle"></i>
                        <span>æœªæŒæ¡</span>
                    </span>
                </h3>
                <span class="phonetic" id="modalPhonetic"></span>
            </div>
            
            <div class="word-details">
                <p><strong><i class="fas fa-language"></i> ä¸­æ–‡é‡Šä¹‰:</strong> <span id="modalChinese"></span></p>
                
                <div class="example">
                    <p><strong><i class="fas fa-quote-right"></i> ä¾‹å¥:</strong></p>
                    <p class="english-example" id="modalExampleEN"></p>
                    <p class="chinese-example" id="modalExampleCN"></p>
                </div>
                
                <div class="word-actions">
                    <button class="speak-btn" id="speakWord">
                        <i class="fas fa-volume-up"></i>
                        <span>æœ—è¯»å•è¯</span>
                    </button>
                    <button class="favorite-btn" id="toggleFavorite">
                        <i class="fas fa-star"></i>
                        <span>æ”¶è—</span>
                    </button>
                    <button class="speak-btn" id="speakExample">
                        <i class="fas fa-microphone"></i>
                        <span>æœ—è¯»ä¾‹å¥</span>
                    </button>
                    <button class="mastery-btn" id="toggleMastery">
                        <i class="fas fa-check-circle"></i>
                        <span>æ ‡è®°æŒæ¡</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ================================
        // æ•°æ®å®šä¹‰éƒ¨åˆ†
        // ================================
        
        // å•è¯æ•°æ® - å¢åŠ  mastered å­—æ®µ
        const demoWords = [
            {
                id: 1,
                chinese: "è‹¹æœ",
                english: "apple",
                phonetic: "/ËˆÃ¦pl/",
                chineseMeaning: "è‹¹æœï¼›è‹¹æœå…¬å¸",
                exampleEN: "I eat an apple every day for breakfast.",
                exampleCN: "æˆ‘æ¯å¤©æ—©é¤éƒ½åƒä¸€ä¸ªè‹¹æœã€‚",
                isFavorite: false,
                mastered: false
            },
            {
                id: 2,
                chinese: "å†’é™©",
                english: "adventure",
                phonetic: "/É™dËˆventÊƒÉ™r/",
                chineseMeaning: "å†’é™©ï¼›å¥‡é‡",
                exampleEN: "Their jungle adventure was full of surprises.",
                exampleCN: "ä»–ä»¬çš„ä¸›æ—å†’é™©å……æ»¡äº†æƒŠå–œã€‚",
                isFavorite: false,
                mastered: false
            },
            {
                id: 3,
                chinese: "ç¾å‘³",
                english: "delicious",
                phonetic: "/dÉªËˆlÉªÊƒÉ™s/",
                chineseMeaning: "ç¾å‘³çš„ï¼Œå¯å£çš„",
                exampleEN: "The cake was absolutely delicious.",
                exampleCN: "è¿™ä¸ªè›‹ç³•ç»å¯¹ç¾å‘³ã€‚",
                isFavorite: false,
                mastered: false
            },
            {
                id: 4,
                chinese: "ç¥ç§˜",
                english: "mysterious",
                phonetic: "/mÉªËˆstÉªriÉ™s/",
                chineseMeaning: "ç¥ç§˜çš„ï¼Œéš¾ä»¥ç†è§£çš„",
                exampleEN: "There was a mysterious package at the door.",
                exampleCN: "é—¨å£æœ‰ä¸€ä¸ªç¥ç§˜çš„åŒ…è£¹ã€‚",
                isFavorite: false,
                mastered: false
            },
            {
                id: 5,
                chinese: "å®è—",
                english: "treasure",
                phonetic: "/ËˆtreÊ’É™r/",
                chineseMeaning: "å®è—ï¼›çå®",
                exampleEN: "The pirates searched for hidden treasure.",
                exampleCN: "æµ·ç›—ä»¬å¯»æ‰¾éšè—çš„å®è—ã€‚",
                isFavorite: false,
                mastered: false
            },
            {
                id: 6,
                chinese: "å‹‡æ•¢",
                english: "brave",
                phonetic: "/breÉªv/",
                chineseMeaning: "å‹‡æ•¢çš„ï¼Œæ— ç•çš„",
                exampleEN: "She was brave enough to face her fears.",
                exampleCN: "å¥¹è¶³å¤Ÿå‹‡æ•¢å»é¢å¯¹è‡ªå·±çš„ææƒ§ã€‚",
                isFavorite: false,
                mastered: false
            },
            {
                id: 7,
                chinese: "é­”æ³•",
                english: "magic",
                phonetic: "/ËˆmÃ¦dÊ’Éªk/",
                chineseMeaning: "é­”æ³•ï¼›é­”æœ¯",
                exampleEN: "The magician performed amazing magic tricks.",
                exampleCN: "é­”æœ¯å¸ˆè¡¨æ¼”äº†ä»¤äººæƒŠå¹çš„é­”æ³•æŠ€å·§ã€‚",
                isFavorite: false,
                mastered: false
            },
            {
                id: 8,
                chinese: "æ—…ç¨‹",
                english: "journey",
                phonetic: "/ËˆdÊ’ÉœËrni/",
                chineseMeaning: "æ—…ç¨‹ï¼Œæ—…è¡Œ",
                exampleEN: "Their journey around the world took two years.",
                exampleCN: "ä»–ä»¬çš„ç¯çƒæ—…è¡ŒèŠ±äº†ä¸¤å¹´æ—¶é—´ã€‚",
                isFavorite: false,
                mastered: false
            },
            {
                id: 9,
                chinese: "æ™ºæ…§",
                english: "wisdom",
                phonetic: "/ËˆwÉªzdÉ™m/",
                chineseMeaning: "æ™ºæ…§ï¼Œæ‰æ™º",
                exampleEN: "Grandfather shared his wisdom with the children.",
                exampleCN: "ç¥–çˆ¶ä¸å­©å­ä»¬åˆ†äº«ä»–çš„æ™ºæ…§ã€‚",
                isFavorite: false,
                mastered: false
            },
            {
                id: 10,
                chinese: "åº†ç¥",
                english: "celebrate",
                phonetic: "/ËˆselÉªbreÉªt/",
                chineseMeaning: "åº†ç¥ï¼Œåº†è´º",
                exampleEN: "We will celebrate our victory with a party.",
                exampleCN: "æˆ‘ä»¬å°†ä¸¾åŠæ´¾å¯¹åº†ç¥èƒœåˆ©ã€‚",
                isFavorite: false,
                mastered: false
            }
        ];

        // æ•…äº‹æ•°æ®
        const demoStory = `åœ¨ä¸€ä¸ªç¥ç§˜çš„æ£®æ—é‡Œï¼Œå°ç‹ç‹¸è‰¾ç±³å¼€å§‹äº†ä¸€åœºæƒŠå¿ƒåŠ¨é­„çš„å†’é™©ã€‚å¥¹å¬è¯´æ£®æ—æ·±å¤„è—ç€ä¼ è¯´ä¸­çš„ç¾å‘³é‡‘è‹¹æœï¼Œè¿™äº›è‹¹æœæœ‰ç€ç¥å¥‡çš„é­”æ³•åŠ›é‡ã€‚

è‰¾ç±³éœ€è¦è¶³å¤Ÿçš„å‹‡æ•¢æ¥å®Œæˆè¿™æ¬¡æ—…ç¨‹ã€‚å¥¹ç©¿è¿‡æµ“é›¾ç¬¼ç½©çš„å³¡è°·ï¼Œè¶Šè¿‡æ¹æ€¥çš„æ²³æµï¼Œè·¯ä¸Šé‡åˆ°äº†å„ç§ç¥ç§˜çš„ç”Ÿç‰©ã€‚ä¸€åªæ™ºæ…§çš„è€çŒ«å¤´é¹°å‘Šè¯‰å¥¹ï¼š"çœŸæ­£çš„å®è—ä¸åœ¨äºæ‰¾åˆ°é‡‘è‹¹æœï¼Œè€Œåœ¨äºæ—…ç¨‹ä¸­è·å¾—çš„æˆé•¿ã€‚"

ç»è¿‡ä¸‰å¤©çš„è·‹æ¶‰ï¼Œè‰¾ç±³ç»ˆäºæ‰¾åˆ°äº†é‚£æ£µé—ªè€€ç€é‡‘è‰²å…‰èŠ’çš„è‹¹æœæ ‘ã€‚æ¯ä¸€é¢—è‹¹æœéƒ½æ•£å‘ç€è¯±äººçš„ç¾å‘³é¦™æ°”ã€‚å¥¹å°å¿ƒåœ°æ‘˜ä¸‹ä¸€é¢—ï¼Œç¬é—´æ„Ÿå—åˆ°äº†æ¸©æš–çš„åŠ›é‡æµè¿‡å…¨èº«ã€‚

å›åˆ°æ‘åº„åï¼Œæ‰€æœ‰çš„åŠ¨ç‰©éƒ½æ¥åº†ç¥è‰¾ç±³çš„å½’æ¥ã€‚å¥¹åˆ†äº«äº†è‡ªå·±çš„ç»å†ï¼Œå¹¶å‘Šè¯‰å¤§å®¶ï¼š"è¿™æ¬¡å†’é™©è®©æˆ‘æ˜ç™½ï¼Œå‹‡æ°”å’Œæ™ºæ…§æ‰æ˜¯äººç”Ÿæœ€å®è´µçš„è´¢å¯Œã€‚"ä»æ­¤ï¼Œæ£®æ—é‡Œæµä¼ ç€è¿™ä¸ªå…³äºå‹‡æ°”å’Œæˆé•¿çš„ç¾ä¸½æ•…äº‹ã€‚`;

        // æ•…äº‹å•è¯æ ‡è®°æ˜ å°„
        const storyWordMapping = [
            { chinese: "ç¥ç§˜", position: 3 },
            { chinese: "å†’é™©", position: 15 },
            { chinese: "ç¾å‘³", position: 40 },
            { chinese: "é­”æ³•", position: 55 },
            { chinese: "å‹‡æ•¢", position: 75 },
            { chinese: "æ—…ç¨‹", position: 85 },
            { chinese: "æ™ºæ…§", position: 115 },
            { chinese: "å®è—", position: 125 },
            { chinese: "è‹¹æœ", position: 160 },
            { chinese: "åº†ç¥", position: 235 }
        ];

        // ================================
        // åº”ç”¨çŠ¶æ€å’ŒDOMå…ƒç´ 
        // ================================
        
        // åº”ç”¨çŠ¶æ€ - å¢åŠ  storyCompleted å­—æ®µ
        let appState = {
            words: [...demoWords],
            story: demoStory,
            wordMapping: [...storyWordMapping],
            showEnglishMode: false,
            currentWord: null,
            speechSupported: false,
            storyCompleted: false
        };

        // DOMå…ƒç´ 
        const storyContainer = document.getElementById('storyContainer');
        const wordsList = document.getElementById('wordsList');
        const wordModal = document.getElementById('wordModal');
        const closeModal = document.getElementById('closeModal');
        const toggleModeBtn = document.getElementById('toggleMode');
        const speakWordBtn = document.getElementById('speakWord');
        const speakExampleBtn = document.getElementById('speakExample');
        const toggleFavoriteBtn = document.getElementById('toggleFavorite');
        const toggleMasteryBtn = document.getElementById('toggleMastery');
        const storyCompleteBtn = document.getElementById('storyCompleteBtn');
        const masteredCountElement = document.getElementById('masteredCount');
        const modalMasteryIndicator = document.getElementById('modalMasteryIndicator');
        const modalEnglishText = document.getElementById('modalEnglishText');

        // ================================
        // æ ¸å¿ƒåŠŸèƒ½å‡½æ•°
        // ================================

        // åˆå§‹åŒ–åº”ç”¨
        function initApp() {
            checkSpeechSupport();
            loadProgress();
            renderStory();
            renderWordsList();
            setupEventListeners();
            loadFavorites();
            updateProgress();
        }

        // æ£€æŸ¥è¯­éŸ³æ”¯æŒ
        function checkSpeechSupport() {
            appState.speechSupported = 'speechSynthesis' in window;
            if (!appState.speechSupported) {
                console.warn('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆåŠŸèƒ½');
            }
        }

        // æ¸²æŸ“æ•…äº‹å†…å®¹
        function renderStory() {
            let storyText = appState.story;
            
            // æ›´æ–°æ•…äº‹å®ŒæˆæŒ‰é’®çŠ¶æ€
            updateStoryCompleteButton();
            
            // æ ¹æ®æ¨¡å¼æ˜¾ç¤ºä¸­æ–‡æˆ–è‹±æ–‡
            if (appState.showEnglishMode) {
                // æ˜¾ç¤ºè‹±æ–‡æ¨¡å¼ï¼šå°†æ•…äº‹ä¸­çš„ä¸­æ–‡å•è¯æ›¿æ¢ä¸ºè‹±æ–‡
                appState.wordMapping.forEach(mapping => {
                    const word = appState.words.find(w => w.chinese === mapping.chinese);
                    if (word) {
                        const className = word.mastered ? 'word-english mastered' : 'word-english';
                        storyText = storyText.replace(
                            new RegExp(mapping.chinese, 'g'),
                            `<span class="${className}" data-word-id="${word.id}">${word.english}</span>`
                        );
                    }
                });
            } else {
                // æ˜¾ç¤ºä¸­æ–‡æ¨¡å¼ï¼šæ ‡è®°ä¸­æ–‡å•è¯
                appState.wordMapping.forEach(mapping => {
                    const word = appState.words.find(w => w.chinese === mapping.chinese);
                    if (word) {
                        const className = word.mastered ? 'word-chinese mastered' : 'word-chinese';
                        storyText = storyText.replace(
                            new RegExp(mapping.chinese, 'g'),
                            `<span class="${className}" data-word-id="${word.id}">${mapping.chinese}</span>`
                        );
                    }
                });
            }
            
            // ä¿ç•™æ•…äº‹å®ŒæˆæŒ‰é’®
            storyContainer.innerHTML = `<p>${storyText}</p>`;
            
            // ä¸ºå•è¯æ·»åŠ ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.word-chinese, .word-english').forEach(element => {
                element.addEventListener('click', function() {
                    const wordId = parseInt(this.getAttribute('data-word-id'));
                    showWordModal(wordId);
                });
            });
        }

        // æ›´æ–°æ•…äº‹å®ŒæˆæŒ‰é’®çŠ¶æ€
        function updateStoryCompleteButton() {
            storyCompleteBtn.classList.toggle('completed', appState.storyCompleted);
            storyCompleteBtn.innerHTML = appState.storyCompleted 
                ? '<i class="fas fa-check-circle"></i><span>æ•…äº‹å·²å­¦å®Œ</span>' 
                : '<i class="fas fa-check-circle"></i><span>æ ‡è®°æ•…äº‹ä¸ºå·²å­¦å®Œ</span>';
        }

        // æ¸²æŸ“å•è¯åˆ—è¡¨
        function renderWordsList() {
            wordsList.innerHTML = '';
            
            appState.words.forEach(word => {
                const wordCard = document.createElement('div');
                wordCard.className = `word-card ${word.mastered ? 'mastered' : ''}`;
                wordCard.setAttribute('data-word-id', word.id);
                
                wordCard.innerHTML = `
                    ${word.mastered ? '<div class="mastery-badge"><i class="fas fa-check"></i></div>' : ''}
                    <div class="favorite-star">${word.isFavorite ? '<i class="fas fa-star"></i>' : '<i class="far fa-star"></i>'}</div>
                    <h4>${word.chinese} <span style="color: var(--text-light); font-weight: 400;">/ ${word.english}</span></h4>
                    <div class="phonetic"><i class="fas fa-volume-up"></i> ${word.phonetic}</div>
                    <div class="meaning">${word.chineseMeaning}</div>
                    <button class="word-mastery-btn ${word.mastered ? 'mastered' : ''}" data-word-id="${word.id}">
                        <i class="fas fa-${word.mastered ? 'check-circle' : 'circle'}"></i>
                        ${word.mastered ? 'å·²æŒæ¡' : 'æ ‡è®°æŒæ¡'}
                    </button>
                `;
                
                wordCard.addEventListener('click', (e) => {
                    // é˜²æ­¢ç‚¹å‡»æŒæ¡æŒ‰é’®æ—¶è§¦å‘å•è¯å¡ç‚¹å‡»
                    if (!e.target.classList.contains('word-mastery-btn') && !e.target.closest('.word-mastery-btn')) {
                        showWordModal(word.id);
                    }
                });
                
                // ä¸ºæŒæ¡æŒ‰é’®æ·»åŠ äº‹ä»¶
                const masteryBtn = wordCard.querySelector('.word-mastery-btn');
                masteryBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleWordMastery(word.id);
                });
                
                // ä¸ºæ”¶è—æ˜Ÿæ˜Ÿæ·»åŠ äº‹ä»¶
                const favoriteStar = wordCard.querySelector('.favorite-star');
                favoriteStar.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleFavoriteForWord(word.id);
                });
                
                wordsList.appendChild(wordCard);
            });
        }

        // æ˜¾ç¤ºå•è¯è¯¦æƒ…å¼¹çª—
        function showWordModal(wordId) {
            const word = appState.words.find(w => w.id === wordId);
            if (!word) return;
            
            appState.currentWord = word;
            
            // æ›´æ–°å¼¹çª—å†…å®¹
            modalEnglishText.textContent = word.english;
            document.getElementById('modalPhonetic').textContent = word.phonetic;
            document.getElementById('modalChinese').textContent = word.chineseMeaning;
            document.getElementById('modalExampleEN').textContent = word.exampleEN;
            document.getElementById('modalExampleCN').textContent = word.exampleCN;
            
            // æ›´æ–°æ”¶è—æŒ‰é’®çŠ¶æ€
            toggleFavoriteBtn.innerHTML = word.isFavorite 
                ? '<i class="fas fa-star"></i><span>å–æ¶ˆæ”¶è—</span>' 
                : '<i class="fas fa-star"></i><span>æ”¶è—</span>';
            toggleFavoriteBtn.classList.toggle('favorited', word.isFavorite);
            
            // æ›´æ–°æŒæ¡æŒ‰é’®çŠ¶æ€
            toggleMasteryBtn.innerHTML = word.mastered 
                ? '<i class="fas fa-check-circle"></i><span>å–æ¶ˆæŒæ¡</span>' 
                : '<i class="fas fa-check-circle"></i><span>æ ‡è®°æŒæ¡</span>';
            toggleMasteryBtn.classList.toggle('mastered', word.mastered);
            
            // æ›´æ–°æŒæ¡æŒ‡ç¤ºå™¨
            const masteryIcon = modalMasteryIndicator.querySelector('i');
            masteryIcon.className = word.mastered ? 'fas fa-check-circle' : 'fas fa-circle';
            modalMasteryIndicator.querySelector('span').textContent = word.mastered ? 'å·²æŒæ¡' : 'æœªæŒæ¡';
            modalMasteryIndicator.classList.toggle('mastered', word.mastered);
            
            // æ˜¾ç¤ºå¼¹çª—
            wordModal.style.display = 'flex';
        }

        // åˆ‡æ¢å•è¯æŒæ¡çŠ¶æ€
        function toggleWordMastery(wordId) {
            const word = appState.words.find(w => w.id === wordId);
            if (!word) return;
            
            word.mastered = !word.mastered;
            
            // å¦‚æœæ˜¯åœ¨å¼¹çª—ä¸­æ“ä½œçš„å½“å‰å•è¯
            if (appState.currentWord && appState.currentWord.id === wordId) {
                toggleMasteryBtn.innerHTML = word.mastered 
                    ? '<i class="fas fa-check-circle"></i><span>å–æ¶ˆæŒæ¡</span>' 
                    : '<i class="fas fa-check-circle"></i><span>æ ‡è®°æŒæ¡</span>';
                toggleMasteryBtn.classList.toggle('mastered', word.mastered);
                
                const masteryIcon = modalMasteryIndicator.querySelector('i');
                masteryIcon.className = word.mastered ? 'fas fa-check-circle' : 'fas fa-circle';
                modalMasteryIndicator.querySelector('span').textContent = word.mastered ? 'å·²æŒæ¡' : 'æœªæŒæ¡';
                modalMasteryIndicator.classList.toggle('mastered', word.mastered);
            }
            
            // æ›´æ–°UI
            renderStory();
            renderWordsList();
            updateProgress();
            
            // ä¿å­˜è¿›åº¦
            saveProgress();
        }

        // åˆ‡æ¢å•è¯æ”¶è—çŠ¶æ€ï¼ˆä»å•è¯å¡ç‰‡ï¼‰
        function toggleFavoriteForWord(wordId) {
            const word = appState.words.find(w => w.id === wordId);
            if (!word) return;
            
            word.isFavorite = !word.isFavorite;
            
            // å¦‚æœæ˜¯åœ¨å¼¹çª—ä¸­æ“ä½œçš„å½“å‰å•è¯
            if (appState.currentWord && appState.currentWord.id === wordId) {
                toggleFavoriteBtn.innerHTML = word.isFavorite 
                    ? '<i class="fas fa-star"></i><span>å–æ¶ˆæ”¶è—</span>' 
                    : '<i class="fas fa-star"></i><span>æ”¶è—</span>';
                toggleFavoriteBtn.classList.toggle('favorited', word.isFavorite);
            }
            
            // æ›´æ–°åˆ—è¡¨æ˜¾ç¤º
            renderWordsList();
            
            // ä¿å­˜åˆ°LocalStorage
            saveFavorites();
        }

        // åˆ‡æ¢æ•…äº‹å®ŒæˆçŠ¶æ€
        function toggleStoryCompleted() {
            appState.storyCompleted = !appState.storyCompleted;
            updateStoryCompleteButton();
            
            // ä¿å­˜è¿›åº¦
            saveProgress();
        }

        // æ›´æ–°å­¦ä¹ è¿›åº¦
        function updateProgress() {
            const masteredWords = appState.words.filter(word => word.mastered).length;
            const totalWords = appState.words.length;
            
            masteredCountElement.textContent = `${masteredWords}/${totalWords}`;
            
            // å¦‚æœæ‰€æœ‰å•è¯éƒ½å·²æŒæ¡ï¼Œè‡ªåŠ¨æ ‡è®°æ•…äº‹ä¸ºå·²å®Œæˆ
            if (masteredWords === totalWords && !appState.storyCompleted) {
                appState.storyCompleted = true;
                updateStoryCompleteButton();
                saveProgress();
            }
        }

        // ä¿å­˜å­¦ä¹ è¿›åº¦åˆ°LocalStorage
        function saveProgress() {
            const progress = {
                storyCompleted: appState.storyCompleted,
                wordMastery: appState.words.map(word => ({
                    id: word.id,
                    mastered: word.mastered
                }))
            };
            
            localStorage.setItem('wordLearningProgress', JSON.stringify(progress));
        }

        // ä»LocalStorageåŠ è½½å­¦ä¹ è¿›åº¦
        function loadProgress() {
            try {
                const savedProgress = JSON.parse(localStorage.getItem('wordLearningProgress'));
                if (savedProgress) {
                    appState.storyCompleted = savedProgress.storyCompleted || false;
                    
                    // æ¢å¤å•è¯æŒæ¡çŠ¶æ€
                    savedProgress.wordMastery?.forEach(item => {
                        const word = appState.words.find(w => w.id === item.id);
                        if (word) {
                            word.mastered = item.mastered;
                        }
                    });
                }
            } catch (error) {
                console.log('åŠ è½½å­¦ä¹ è¿›åº¦å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®');
            }
        }

        // ä¿®å¤è¯­éŸ³æœ—è¯»åŠŸèƒ½
        function speakText(text, lang = 'en-US') {
            if (!appState.speechSupported) {
                alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³æœ—è¯»åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨Chromeã€Edgeã€Safariç­‰ç°ä»£æµè§ˆå™¨');
                return;
            }
            
            try {
                // åœæ­¢ä»»ä½•æ­£åœ¨è¿›è¡Œçš„è¯­éŸ³
                window.speechSynthesis.cancel();
                
                // åˆ›å»ºä¸€ä¸ªæ–°çš„è¯­éŸ³å®ä¾‹
                const utterance = new SpeechSynthesisUtterance();
                utterance.text = text;
                utterance.lang = lang;
                utterance.rate = 0.8;
                utterance.pitch = 1;
                utterance.volume = 1;
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                utterance.onstart = function() {
                    console.log('å¼€å§‹æœ—è¯»:', text);
                };
                
                utterance.onend = function() {
                    console.log('æœ—è¯»ç»“æŸ');
                };
                
                utterance.onerror = function(event) {
                    console.error('è¯­éŸ³æœ—è¯»é”™è¯¯:', event);
                    alert('è¯­éŸ³æœ—è¯»å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®æˆ–é‡è¯•');
                };
                
                // ç«‹å³å¼€å§‹æœ—è¯»
                window.speechSynthesis.speak(utterance);
                
            } catch (error) {
                console.error('è¯­éŸ³æœ—è¯»å¼‚å¸¸:', error);
                alert('è¯­éŸ³æœ—è¯»åŠŸèƒ½å¼‚å¸¸ï¼Œè¯·é‡è¯•æˆ–æ£€æŸ¥æµè§ˆå™¨è®¾ç½®');
            }
        }

        // åˆ‡æ¢æ”¶è—çŠ¶æ€ï¼ˆä»å¼¹çª—ï¼‰
        function toggleFavorite() {
            if (!appState.currentWord) return;
            
            const word = appState.currentWord;
            word.isFavorite = !word.isFavorite;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            toggleFavoriteBtn.innerHTML = word.isFavorite 
                ? '<i class="fas fa-star"></i><span>å–æ¶ˆæ”¶è—</span>' 
                : '<i class="fas fa-star"></i><span>æ”¶è—</span>';
            toggleFavoriteBtn.classList.toggle('favorited', word.isFavorite);
            
            // æ›´æ–°åˆ—è¡¨æ˜¾ç¤º
            renderWordsList();
            
            // ä¿å­˜åˆ°LocalStorage
            saveFavorites();
        }

        // ä¿å­˜æ”¶è—çŠ¶æ€åˆ°LocalStorage
        function saveFavorites() {
            const favorites = appState.words
                .filter(word => word.isFavorite)
                .map(word => word.id);
            
            localStorage.setItem('wordFavorites', JSON.stringify(favorites));
        }

        // ä»LocalStorageåŠ è½½æ”¶è—çŠ¶æ€
        function loadFavorites() {
            try {
                const favorites = JSON.parse(localStorage.getItem('wordFavorites') || '[]');
                
                appState.words.forEach(word => {
                    word.isFavorite = favorites.includes(word.id);
                });
                
                renderWordsList();
            } catch (error) {
                console.log('åŠ è½½æ”¶è—æ•°æ®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®');
            }
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // åˆ‡æ¢æ˜¾ç¤ºæ¨¡å¼
            toggleModeBtn.addEventListener('click', () => {
                appState.showEnglishMode = !appState.showEnglishMode;
                toggleModeBtn.innerHTML = appState.showEnglishMode 
                    ? '<i class="fas fa-language"></i><span>æ˜¾ç¤ºä¸­æ–‡æ¨¡å¼</span>' 
                    : '<i class="fas fa-language"></i><span>æ˜¾ç¤ºè‹±æ–‡æ¨¡å¼</span>';
                renderStory();
            });
            
            // æ•…äº‹å®ŒæˆæŒ‰é’®
            storyCompleteBtn.addEventListener('click', toggleStoryCompleted);
            
            // å…³é—­å¼¹çª—
            closeModal.addEventListener('click', () => {
                wordModal.style.display = 'none';
                if (appState.speechSupported) {
                    window.speechSynthesis.cancel();
                }
            });
            
            // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
            wordModal.addEventListener('click', (e) => {
                if (e.target === wordModal) {
                    wordModal.style.display = 'none';
                    if (appState.speechSupported) {
                        window.speechSynthesis.cancel();
                    }
                }
            });
            
            // è¯­éŸ³åŠŸèƒ½
            speakWordBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                if (appState.currentWord) {
                    console.log('æœ—è¯»å•è¯:', appState.currentWord.english);
                    speakText(appState.currentWord.english, 'en-US');
                }
            });
            
            speakExampleBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                if (appState.currentWord) {
                    console.log('æœ—è¯»ä¾‹å¥:', appState.currentWord.exampleEN);
                    speakText(appState.currentWord.exampleEN, 'en-US');
                }
            });
            
            // æ”¶è—åŠŸèƒ½
            toggleFavoriteBtn.addEventListener('click', toggleFavorite);
            
            // æŒæ¡åŠŸèƒ½
            toggleMasteryBtn.addEventListener('click', () => {
                if (appState.currentWord) {
                    toggleWordMastery(appState.currentWord.id);
                }
            });
            
            // ESCé”®å…³é—­å¼¹çª—
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && wordModal.style.display === 'flex') {
                    wordModal.style.display = 'none';
                    if (appState.speechSupported) {
                        window.speechSynthesis.cancel();
                    }
                }
            });
        }

        // ================================
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åº”ç”¨
        // ================================
        document.addEventListener('DOMContentLoaded', initApp);

        // ================================
        // æµ‹è¯•åŠŸèƒ½ï¼ˆæ§åˆ¶å°å¯ç”¨ï¼‰
        // ================================
        window.testFunctions = {
            // æ˜¾ç¤ºæ‰€æœ‰å•è¯
            showAllWords: function() {
                console.log('æ‰€æœ‰å•è¯:', appState.words);
                return appState.words;
            },
            
            // æ˜¾ç¤ºæ”¶è—çš„å•è¯
            showFavorites: function() {
                const favorites = appState.words.filter(word => word.isFavorite);
                console.log('æ”¶è—çš„å•è¯:', favorites);
                return favorites;
            },
            
            // æ˜¾ç¤ºå·²æŒæ¡çš„å•è¯
            showMasteredWords: function() {
                const mastered = appState.words.filter(word => word.mastered);
                console.log('å·²æŒæ¡çš„å•è¯:', mastered);
                return mastered;
            },
            
            // æ¸…é™¤æ‰€æœ‰æ”¶è—
            clearFavorites: function() {
                appState.words.forEach(word => word.isFavorite = false);
                localStorage.removeItem('wordFavorites');
                renderWordsList();
                console.log('å·²æ¸…é™¤æ‰€æœ‰æ”¶è—');
            },
            
            // æ¸…é™¤æ‰€æœ‰æŒæ¡æ ‡è®°
            clearMastery: function() {
                appState.words.forEach(word => word.mastered = false);
                appState.storyCompleted = false;
                localStorage.removeItem('wordLearningProgress');
                renderStory();
                renderWordsList();
                updateProgress();
                console.log('å·²æ¸…é™¤æ‰€æœ‰æŒæ¡æ ‡è®°');
            },
            
            // æ ‡è®°æ‰€æœ‰å•è¯ä¸ºå·²æŒæ¡
            markAllMastered: function() {
                appState.words.forEach(word => word.mastered = true);
                appState.storyCompleted = true;
                saveProgress();
                renderStory();
                renderWordsList();
                updateProgress();
                console.log('å·²æ ‡è®°æ‰€æœ‰å•è¯ä¸ºå·²æŒæ¡');
            },
            
            // æ·»åŠ æµ‹è¯•å•è¯
            addTestWord: function() {
                const newWord = {
                    id: appState.words.length + 1,
                    chinese: "æµ‹è¯•",
                    english: "test",
                    phonetic: "/test/",
                    chineseMeaning: "æµ‹è¯•ï¼Œè¯•éªŒ",
                    exampleEN: "This is a test sentence.",
                    exampleCN: "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å¥å­ã€‚",
                    isFavorite: false,
                    mastered: false
                };
                appState.words.push(newWord);
                renderWordsList();
                updateProgress();
                console.log('å·²æ·»åŠ æµ‹è¯•å•è¯:', newWord);
            },
            
            // æµ‹è¯•è¯­éŸ³åŠŸèƒ½
            testSpeech: function() {
                if (appState.speechSupported) {
                    const testText = "Hello, this is a test of the speech synthesis function.";
                    speakText(testText, 'en-US');
                    console.log('è¯­éŸ³æµ‹è¯•å¼€å§‹...');
                } else {
                    console.log('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ');
                }
            },
            
            // æ£€æŸ¥è¯­éŸ³æ”¯æŒçŠ¶æ€
            checkSpeech: function() {
                console.log('è¯­éŸ³æ”¯æŒçŠ¶æ€:', appState.speechSupported ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ');
                console.log('å¯ç”¨è¯­éŸ³:', window.speechSynthesis ? window.speechSynthesis.getVoices() : 'æ— ');
                return appState.speechSupported;
            }
        };

        // åœ¨æ§åˆ¶å°æç¤ºå¯ç”¨æµ‹è¯•å‡½æ•°
        console.log('%cğŸ® æµ‹è¯•åŠŸèƒ½å¯ç”¨:', 'color: #4f46e5; font-weight: bold; font-size: 14px;');
        console.log('%c  - testFunctions.showAllWords() - æ˜¾ç¤ºæ‰€æœ‰å•è¯', 'color: #64748b;');
        console.log('%c  - testFunctions.showFavorites() - æ˜¾ç¤ºæ”¶è—çš„å•è¯', 'color: #64748b;');
        console.log('%c  - testFunctions.showMasteredWords() - æ˜¾ç¤ºå·²æŒæ¡çš„å•è¯', 'color: #64748b;');
        console.log('%c  - testFunctions.clearFavorites() - æ¸…é™¤æ‰€æœ‰æ”¶è—', 'color: #64748b;');
        console.log('%c  - testFunctions.clearMastery() - æ¸…é™¤æ‰€æœ‰æŒæ¡æ ‡è®°', 'color: #64748b;');
        console.log('%c  - testFunctions.markAllMastered() - æ ‡è®°æ‰€æœ‰å•è¯ä¸ºå·²æŒæ¡', 'color: #64748b;');
        console.log('%c  - testFunctions.addTestWord() - æ·»åŠ æµ‹è¯•å•è¯', 'color: #64748b;');
        console.log('%c  - testFunctions.testSpeech() - æµ‹è¯•è¯­éŸ³åŠŸèƒ½', 'color: #64748b;');
        console.log('%c  - testFunctions.checkSpeech() - æ£€æŸ¥è¯­éŸ³æ”¯æŒçŠ¶æ€', 'color: #64748b;');
    </script>
</body>
</html>